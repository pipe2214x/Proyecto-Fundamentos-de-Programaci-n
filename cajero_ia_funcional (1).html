<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cajero Autom√°tico con IA</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 20px;
        }
        
        .atm-container {
            background: #2d3748;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.5);
            max-width: 450px;
            width: 100%;
        }
        
        .atm-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin-bottom: 20px;
        }
        
        .atm-header h1 {
            color: white;
            font-size: 24px;
            margin-bottom: 5px;
        }
        
        .atm-header p {
            color: rgba(255,255,255,0.8);
            font-size: 14px;
        }
        
        .screen {
            background: #1a202c;
            border-radius: 10px;
            padding: 20px;
            min-height: 300px;
            margin-bottom: 20px;
            color: white;
        }
        
        .welcome-screen h2 {
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .balance-display {
            background: #667eea;
            padding: 20px;
            border-radius: 10px;
            text-align: center;
            margin: 15px 0;
        }
        
        .balance-display h3 {
            font-size: 16px;
            margin-bottom: 10px;
            opacity: 0.9;
        }
        
        .balance-amount {
            font-size: 36px;
            font-weight: bold;
        }
        
        .menu-buttons {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-top: 15px;
        }
        
        .menu-btn {
            background: #4a5568;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .menu-btn:hover {
            background: #667eea;
            transform: translateY(-2px);
        }
        
        .input-group {
            margin: 15px 0;
        }
        
        .input-group label {
            display: block;
            margin-bottom: 8px;
            color: #a0aec0;
        }
        
        .input-group input {
            width: 100%;
            padding: 12px;
            border-radius: 8px;
            border: 2px solid #4a5568;
            background: #2d3748;
            color: white;
            font-size: 16px;
        }
        
        .input-group input:focus {
            outline: none;
            border-color: #667eea;
        }
        
        .action-btn {
            background: #667eea;
            color: white;
            border: none;
            padding: 15px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            width: 100%;
            margin-top: 10px;
            transition: all 0.3s;
        }
        
        .action-btn:hover {
            background: #764ba2;
            transform: translateY(-2px);
        }
        
        .back-btn {
            background: #4a5568;
            margin-top: 10px;
        }
        
        .back-btn:hover {
            background: #2d3748;
        }
        
        .ai-chat {
            background: #2d3748;
            border-radius: 10px;
            padding: 15px;
            margin-top: 15px;
            max-height: 250px;
            overflow-y: auto;
        }
        
        .ai-message {
            background: #4a5568;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .user-message {
            background: #667eea;
            text-align: right;
        }
        
        .chat-input {
            display: flex;
            gap: 10px;
            margin-top: 10px;
        }
        
        .chat-input input {
            flex: 1;
            padding: 10px;
            border-radius: 8px;
            border: 2px solid #4a5568;
            background: #2d3748;
            color: white;
        }
        
        .chat-input button {
            padding: 10px 20px;
            background: #667eea;
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .chat-input button:hover {
            background: #764ba2;
        }
        
        .hidden {
            display: none;
        }
        
        .transaction-list {
            max-height: 200px;
            overflow-y: auto;
        }
        
        .transaction-item {
            background: #4a5568;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
        }
        
        .loading {
            text-align: center;
            padding: 10px;
            color: #a0aec0;
            animation: pulse 1.5s infinite;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }

        .quick-questions {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin: 10px 0;
        }

        .quick-btn {
            background: #4a5568;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 6px;
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s;
        }

        .quick-btn:hover {
            background: #667eea;
        }
    </style>
</head>
<body>
    <div class="atm-container">
        <div class="atm-header">
            <h1>üè¶ Cajero Inteligente</h1>
            <p>Asistido por IA</p>
        </div>
        
        <div class="screen">
            <!-- Pantalla de bienvenida -->
            <div id="welcomeScreen" class="welcome-screen">
                <h2>Bienvenido</h2>
                <p>Ingrese su tarjeta para comenzar</p>
                <div class="input-group">
                    <label>N√∫mero de Tarjeta</label>
                    <input type="text" id="cardNumber" placeholder="1234 5678 9012 3456" maxlength="19">
                </div>
                <div class="input-group">
                    <label>PIN</label>
                    <input type="password" id="pin" placeholder="****" maxlength="4">
                </div>
                <button class="action-btn" onclick="login()">Ingresar</button>
            </div>
            
            <!-- Men√∫ principal -->
            <div id="mainMenu" class="hidden">
                <h2>Men√∫ Principal</h2>
                <div class="balance-display">
                    <h3>Saldo Disponible</h3>
                    <div class="balance-amount" id="balance">$5,000.00</div>
                </div>
                <div class="menu-buttons">
                    <button class="menu-btn" onclick="showScreen('withdrawScreen')">üíµ Retirar</button>
                    <button class="menu-btn" onclick="showScreen('depositScreen')">üí∞ Depositar</button>
                    <button class="menu-btn" onclick="showScreen('transferScreen')">üì§ Transferir</button>
                    <button class="menu-btn" onclick="showScreen('historyScreen')">üìã Historial</button>
                    <button class="menu-btn" onclick="showScreen('aiScreen')">ü§ñ Asistente IA</button>
                    <button class="menu-btn" onclick="logout()">üö™ Salir</button>
                </div>
            </div>
            
            <!-- Pantalla de retiro -->
            <div id="withdrawScreen" class="hidden">
                <h2>Retirar Efectivo</h2>
                <div class="input-group">
                    <label>Monto a retirar</label>
                    <input type="number" id="withdrawAmount" placeholder="Ingrese el monto">
                </div>
                <button class="action-btn" onclick="withdraw()">Retirar</button>
                <button class="action-btn back-btn" onclick="showScreen('mainMenu')">Volver</button>
            </div>
            
            <!-- Pantalla de dep√≥sito -->
            <div id="depositScreen" class="hidden">
                <h2>Depositar Efectivo</h2>
                <div class="input-group">
                    <label>Monto a depositar</label>
                    <input type="number" id="depositAmount" placeholder="Ingrese el monto">
                </div>
                <button class="action-btn" onclick="deposit()">Depositar</button>
                <button class="action-btn back-btn" onclick="showScreen('mainMenu')">Volver</button>
            </div>
            
            <!-- Pantalla de transferencia -->
            <div id="transferScreen" class="hidden">
                <h2>Transferir Dinero</h2>
                <div class="input-group">
                    <label>Cuenta destino</label>
                    <input type="text" id="transferAccount" placeholder="N√∫mero de cuenta">
                </div>
                <div class="input-group">
                    <label>Monto</label>
                    <input type="number" id="transferAmount" placeholder="Ingrese el monto">
                </div>
                <button class="action-btn" onclick="transfer()">Transferir</button>
                <button class="action-btn back-btn" onclick="showScreen('mainMenu')">Volver</button>
            </div>
            
            <!-- Pantalla de historial -->
            <div id="historyScreen" class="hidden">
                <h2>Historial de Transacciones</h2>
                <div class="transaction-list" id="transactionList">
                    <div class="transaction-item">
                        <span>Retiro</span>
                        <span>-$500.00</span>
                    </div>
                    <div class="transaction-item">
                        <span>Dep√≥sito</span>
                        <span>+$1,000.00</span>
                    </div>
                </div>
                <button class="action-btn back-btn" onclick="showScreen('mainMenu')">Volver</button>
            </div>
            
            <!-- Pantalla de IA -->
            <div id="aiScreen" class="hidden">
                <h2>ü§ñ Asistente con IA</h2>
                <p style="font-size: 13px; color: #a0aec0; margin-bottom: 10px;">Preg√∫ntame sobre tu saldo, transacciones o l√≠mites de operaci√≥n</p>
                
                <div class="quick-questions">
                    <button class="quick-btn" onclick="askQuickQuestion('¬øCu√°l es mi saldo?')">üí∞ Mi saldo</button>
                    <button class="quick-btn" onclick="askQuickQuestion('Muestra mi historial')">üìã Historial</button>
                    <button class="quick-btn" onclick="askQuickQuestion('¬øCu√°nto puedo retirar?')">üíµ L√≠mites</button>
                </div>

                <div class="ai-chat" id="aiChat">
                    <div class="ai-message">
                        ¬°Hola! üëã Soy tu asistente bancario inteligente. Puedo ayudarte con:
                        <br><br>
                        ‚Ä¢ Consultar tu saldo actual<br>
                        ‚Ä¢ Revisar tu historial de transacciones<br>
                        ‚Ä¢ Informarte sobre l√≠mites de retiro y transferencia<br>
                        ‚Ä¢ Responder dudas sobre operaciones del cajero<br>
                        <br>
                        ¬øEn qu√© puedo ayudarte?
                    </div>
                </div>
                <div class="chat-input">
                    <input type="text" id="aiInput" placeholder="Escribe tu pregunta..." maxlength="200">
                    <button onclick="sendAIMessage()">Enviar</button>
                </div>
                <button class="action-btn back-btn" onclick="showScreen('mainMenu')">Volver</button>
            </div>
        </div>
    </div>

    <script>
        let balance = 5000;
        let transactions = [
            { type: 'Retiro', amount: -500, date: new Date(Date.now() - 86400000) },
            { type: 'Dep√≥sito', amount: 1000, date: new Date(Date.now() - 172800000) },
            { type: 'Transferencia enviada', amount: -250, date: new Date(Date.now() - 259200000) },
            { type: 'Dep√≥sito', amount: 2000, date: new Date(Date.now() - 345600000) }
        ];
        
        const DAILY_WITHDRAWAL_LIMIT = 3000;
        const TRANSFER_LIMIT = 5000;
        const MIN_BALANCE = 10;

        function showScreen(screenId) {
            document.querySelectorAll('.screen > div').forEach(div => {
                div.classList.add('hidden');
            });
            document.getElementById(screenId).classList.remove('hidden');
            
            if (screenId === 'mainMenu') {
                updateBalance();
            }
            if (screenId === 'historyScreen') {
                updateTransactionHistory();
            }
        }

        function login() {
            const cardNumber = document.getElementById('cardNumber').value;
            const pin = document.getElementById('pin').value;
            
            if (cardNumber && pin.length === 4) {
                showScreen('mainMenu');
            } else {
                alert('Por favor ingrese un n√∫mero de tarjeta y PIN v√°lido');
            }
        }

        function logout() {
            showScreen('welcomeScreen');
            document.getElementById('cardNumber').value = '';
            document.getElementById('pin').value = '';
        }

        function updateBalance() {
            document.getElementById('balance').textContent = `$${balance.toFixed(2).replace(/\B(?=(\d{3})+(?!\d))/g, ",")}`;
        }

        function withdraw() {
            const amount = parseFloat(document.getElementById('withdrawAmount').value);
            if (amount > 0 && amount <= balance && amount <= DAILY_WITHDRAWAL_LIMIT) {
                if (balance - amount < MIN_BALANCE) {
                    alert(`No puede dejar su cuenta con menos de $${MIN_BALANCE}`);
                    return;
                }
                balance -= amount;
                transactions.unshift({ type: 'Retiro', amount: -amount, date: new Date() });
                alert(`Retiro exitoso: $${amount.toFixed(2)}`);
                document.getElementById('withdrawAmount').value = '';
                showScreen('mainMenu');
            } else if (amount > DAILY_WITHDRAWAL_LIMIT) {
                alert(`El l√≠mite diario de retiro es $${DAILY_WITHDRAWAL_LIMIT}`);
            } else {
                alert('Monto inv√°lido o saldo insuficiente');
            }
        }

        function deposit() {
            const amount = parseFloat(document.getElementById('depositAmount').value);
            if (amount > 0) {
                balance += amount;
                transactions.unshift({ type: 'Dep√≥sito', amount: amount, date: new Date() });
                alert(`Dep√≥sito exitoso: $${amount.toFixed(2)}`);
                document.getElementById('depositAmount').value = '';
                showScreen('mainMenu');
            } else {
                alert('Monto inv√°lido');
            }
        }

        function transfer() {
            const account = document.getElementById('transferAccount').value;
            const amount = parseFloat(document.getElementById('transferAmount').value);
            
            if (account && amount > 0 && amount <= balance && amount <= TRANSFER_LIMIT) {
                balance -= amount;
                transactions.unshift({ type: `Transferencia a ${account.slice(-4)}`, amount: -amount, date: new Date() });
                alert(`Transferencia exitosa: $${amount.toFixed(2)} a cuenta ${account}`);
                document.getElementById('transferAccount').value = '';
                document.getElementById('transferAmount').value = '';
                showScreen('mainMenu');
            } else if (amount > TRANSFER_LIMIT) {
                alert(`El l√≠mite de transferencia es $${TRANSFER_LIMIT}`);
            } else {
                alert('Datos inv√°lidos o saldo insuficiente');
            }
        }

        function updateTransactionHistory() {
            const list = document.getElementById('transactionList');
            list.innerHTML = transactions.map(t => `
                <div class="transaction-item">
                    <div>
                        <div>${t.type}</div>
                        <div style="font-size: 11px; color: #a0aec0;">${t.date.toLocaleDateString()}</div>
                    </div>
                    <span style="color: ${t.amount > 0 ? '#48bb78' : '#f56565'}; font-weight: bold;">${t.amount > 0 ? '+' : ''}$${Math.abs(t.amount).toFixed(2)}</span>
                </div>
            `).join('');
        }

        // IA Asistente inteligente
        function getAIResponse(message) {
            const msg = message.toLowerCase();
            
            // Calcular retiros de hoy
            const todayWithdrawals = transactions
                .filter(t => t.type === 'Retiro' && new Date(t.date).toDateString() === new Date().toDateString())
                .reduce((sum, t) => sum + Math.abs(t.amount), 0);
            
            const remainingWithdrawal = DAILY_WITHDRAWAL_LIMIT - todayWithdrawals;
            
            // Respuestas sobre saldo
            if (msg.includes('saldo') || msg.includes('dinero') || msg.includes('cuanto tengo')) {
                return `üí∞ Tu saldo actual es de <strong>$${balance.toFixed(2)}</strong>. ${balance > 1000 ? '¬°Tienes buen balance en tu cuenta!' : 'Considera hacer un dep√≥sito pronto.'}`;
            }
            
            // Respuestas sobre retiros
            if (msg.includes('retirar') || msg.includes('retiro') || msg.includes('sacar')) {
                if (msg.includes('cuanto') || msg.includes('l√≠mite') || msg.includes('limite') || msg.includes('m√°ximo') || msg.includes('maximo')) {
                    return `üíµ El l√≠mite de retiro diario es de <strong>$${DAILY_WITHDRAWAL_LIMIT}</strong>. Hoy has retirado $${todayWithdrawals.toFixed(2)}, por lo que puedes retirar hasta <strong>$${remainingWithdrawal.toFixed(2)}</strong> m√°s.`;
                }
                return `üíµ Para retirar efectivo, ve al men√∫ principal y selecciona "Retirar". Recuerda que el l√≠mite diario es de $${DAILY_WITHDRAWAL_LIMIT} y actualmente tienes $${balance.toFixed(2)} disponible.`;
            }
            
            // Respuestas sobre transferencias
            if (msg.includes('transferir') || msg.includes('transferencia') || msg.includes('enviar dinero')) {
                if (msg.includes('l√≠mite') || msg.includes('limite') || msg.includes('m√°ximo') || msg.includes('maximo') || msg.includes('cuanto')) {
                    return `üì§ El l√≠mite por transferencia es de <strong>$${TRANSFER_LIMIT}</strong>. Puedes transferir hasta esa cantidad en una sola operaci√≥n.`;
                }
                return `üì§ Para transferir dinero, selecciona "Transferir" en el men√∫ principal. Necesitar√°s el n√∫mero de cuenta destino. El l√≠mite por transferencia es de $${TRANSFER_LIMIT}.`;
            }
            
            // Respuestas sobre dep√≥sitos
            if (msg.includes('depositar') || msg.includes('dep√≥sito') || msg.includes('deposito')) {
                return `üí∞ Para depositar efectivo, ve a la opci√≥n "Depositar" en el men√∫ principal. No hay l√≠mite para dep√≥sitos en cajero.`;
            }
            
            // Respuestas sobre historial/transacciones
            if (msg.includes('historial') || msg.includes('transacciones') || msg.includes('movimientos') || msg.includes('√∫ltimas') || msg.includes('ultimas')) {
                const last3 = transactions.slice(0, 3);
                let response = `üìã Tus √∫ltimas transacciones son:<br><br>`;
                last3.forEach(t => {
                    response += `‚Ä¢ ${t.type}: ${t.amount > 0 ? '+' : ''}$${Math.abs(t.amount).toFixed(2)} (${t.date.toLocaleDateString()})<br>`;
                });
                response += `<br>Para ver el historial completo, selecciona "Historial" en el men√∫.`;
                return response;
            }
            
            // Respuestas sobre l√≠mites generales
            if (msg.includes('l√≠mite') || msg.includes('limite')) {
                return `üìä Los l√≠mites de operaci√≥n son:<br><br>‚Ä¢ Retiro diario: $${DAILY_WITHDRAWAL_LIMIT}<br>‚Ä¢ Transferencia: $${TRANSFER_LIMIT}<br>‚Ä¢ Saldo m√≠nimo: $${MIN_BALANCE}<br><br>¬øNecesitas m√°s informaci√≥n sobre alguno?`;
            }
            
            // Respuestas sobre ayuda/opciones
            if (msg.includes('ayuda') || msg.includes('qu√© puedes hacer') || msg.includes('que puedes hacer') || msg.includes('opciones')) {
                return `ü§ñ Puedo ayudarte con:<br><br>‚Ä¢ Consultar tu saldo<br>‚Ä¢ Ver tu historial de transacciones<br>‚Ä¢ Informarte sobre l√≠mites de retiro y transferencia<br>‚Ä¢ Guiarte en c√≥mo realizar operaciones<br><br>Solo preg√∫ntame lo que necesites saber sobre tu cuenta o el cajero.`;
            }
            
            // Respuestas sobre PIN/seguridad
            if (msg.includes('pin') || msg.includes('contrase√±a') || msg.includes('cambiar') || msg.includes('seguridad')) {
                return `üîí Por seguridad, el cambio de PIN debe realizarse en sucursal o a trav√©s de la banca en l√≠nea. El cajero autom√°tico no permite modificar el PIN.`;
            }
            
            // Preguntas no relacionadas con el cajero
            if (msg.includes('clima') || msg.includes('hora') || msg.includes('pol√≠tica') || msg.includes('pol√≠tica') || 
                msg.includes('receta') || msg.includes('m√∫sica') || msg.includes('musica') || msg.includes('pel√≠cula') || msg.includes('pelicula')) {
                return `Lo siento, solo puedo ayudarte con consultas relacionadas al cajero autom√°tico y tus operaciones bancarias. ¬øTienes alguna pregunta sobre tu saldo, transacciones o l√≠mites?`;
            }
            
            // Respuesta por defecto
            return `ü§î No estoy seguro de entender tu pregunta. Puedo ayudarte con:<br><br>‚Ä¢ Tu saldo actual<br>‚Ä¢ Historial de transacciones<br>‚Ä¢ L√≠mites de retiro y transferencia<br>‚Ä¢ C√≥mo realizar operaciones<br><br>¬øSobre cu√°l te gustar√≠a saber m√°s?`;
        }

        function askQuickQuestion(question) {
            document.getElementById('aiInput').value = question;
            sendAIMessage();
        }

        function sendAIMessage() {
            const input = document.getElementById('aiInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            const chatDiv = document.getElementById('aiChat');
            chatDiv.innerHTML += `<div class="ai-message user-message">${message}</div>`;
            input.value = '';
            
            // Simular tiempo de procesamiento
            chatDiv.innerHTML += `<div class="ai-message loading">Procesando...</div>`;
            chatDiv.scrollTop = chatDiv.scrollHeight;
            
            setTimeout(() => {
                const loadingMsg = chatDiv.querySelector('.loading');
                if (loadingMsg) loadingMsg.remove();
                
                const response = getAIResponse(message);
                chatDiv.innerHTML += `<div class="ai-message">${response}</div>`;
                chatDiv.scrollTop = chatDiv.scrollHeight;
            }, 800);
        }

        document.getElementById('aiInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendAIMessage();
        });
    </script>
</body>
</html>